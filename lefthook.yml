# Pre-commit jobs align with Cursor hooks: style (prettier/ruff) + security (no secret env files).
# Cursor beforeShellExecution (bun vs npm, venv) has no pre-commit analogue — we run fixed commands (bunx, run_ruff.sh).
pre-commit:
  parallel: true
  jobs:
    # Cursor: beforeReadFile (security) — no-exposed-secrets
    - name: no-secret-files
      run: sh scripts/check_no_secret_files.sh

    - name: prettier
      root: "frontend/"
      glob: "frontend/**/*.{ts,tsx,js,jsx,mjs,json,css,md}"
      run: bunx prettier --write {staged_files}
      stage_fixed: true

    - name: ruff-format
      glob: "backend/**/*.py"
      run: sh scripts/run_ruff.sh format {staged_files}
      stage_fixed: true

    - name: ruff-lint
      glob: "backend/**/*.py"
      run: sh scripts/run_ruff.sh check --fix {staged_files}
      stage_fixed: true
